AC_INIT(Makefile)

PACKAGE=magick
VERSION=2.0

CFLAGS="$CFLAGS -fno-default-inline"
CPPFLAGS="$CPPFLAGS -fno-default-inline"

AC_PROG_MAKE_SET(make)
AC_PROG_INSTALL(install-sh)
AC_ARG_PROGRAM

AC_PROG_CC
AC_PROG_CXX
AC_PROG_RANLIB

AC_CHECK_LIB(ACE,	_make_ACE_Naming_Context,	LIBS="$LIBS -lACE")
AC_CHECK_LIB(pthread,	pthread_create,			LIBS="$LIBS -lpthread")
AC_CHECK_LIB(c_r,	pthread_create,			LIBS="$LIBS -pthread")
AC_CHECK_LIB(z,		inflate,			LIBS="$LIBS -lz")

AC_DEFINE(MAGICK_HAS_EXCEPTIONS)


AC_ARG_WITH(DES, [Add DES encryption to Magick (default)],
	[case "${enablevel}" in
		yes) des=false;;
		no) des=true;;
		*) AC_MSG_ERROR(bad value ${enablevel for DES option);;
	 esac], [des=true])
if test "$des" = "true"; then
	AC_DEFINE(HASCRYPT)
fi

AC_OUTPUT([Makefile src/antlr/Makefile src/des/Makefile src/xml/Makefile src/Makefile \
		docs/Makefile])
