Magick IRC Services

$Id$
(c) 1997-2000 Preston A. Elder <prez@magick.tm>
(c) 1998-2000 William King <ungod@magick.tm>

Magick Services are released under the GNU General Public
License, see the "COPYING" file for further details.  By
downloading this software you are bound by the terms and
conditions described therein.

CONTENTS
========

Please read the file "AUTHORS" to find out about who
wrote Magick, and how to be on the testing teams.
Please read the file "INSTALL" for information about
how to compile and install Magick on your system.
Please read the file "ChangeLog" for a summary list
of changes since the previous release of Magick.

1. DEDICATION
2. INTRUDUCTION
3. SUPPORT FILES
4. OPERATION
5. FUNCTIONALITY

1. DEDICATION
=============

Magick is dedicated to the memory of PreZ's loving sister,
Stacey Louise Elder (1st Jan, 1975 - 25th Feb, 1998). She
has been there for me more than anyone over the years, and I
was distraught when she died, may her Lord love her as much
as I did, and keep her safe like I could not. Merry Parting,
Dear Sister.

Magick is also dedicated to the memory of Ungod's brother,
Edward Kevin King (28th Aug, 1982 - 21st Nov, 1997), His
life was short, but his memory is great, never will those
who knew him forget him.

2. INTRODUCTION
===============

Magick IRC Services are a program that is designed to interface
with an Internet Relay Chat (IRC) network, and offer its users,
operators and administrators services such as the ability to
register nicknames so they cannot be taken by anyone else, the
ability to register channels with pre-defined access lists and
kick lists so that channels may not be taken over, the ability
to leave offline messages for other users, and many network
control mechanisms to stop things like flooding, abusive users,
and many other things.

Magick services adhere to RFC 1459, and many variants of it.
The changes to the base protocol will not be discussed in this
document, as there are too many of them, and so many different
destinct protocols around nowdays, however Magick has been
designed to cope with them all, with a minimum of fuss (as long
as they support services of this nature).

3. SUPPORT FILES
================

All files and directories listed are relative to the current
'Services Directory'. The services directory is set with the
--dir commandline option. If none is specified, it will default
to the current directory.

magick.ini - This file is included with your Magick distribution
in the docs directory.  This file must either be specified on the
commandline with the --config option, or in the services directory.
This file contains all settings that Magick II will use throughout
its execution (these can be changed and reloaded online).

magick.mnd - This is the Magick New Datafile (or mound) file.  This
stores all data that is stored by Magick.  This file is not human
readable, and is often encrypted and/or compressed.  This filename
is a setting in the magick.ini file, and may be changed.  This file
will be created if it does not exist.

magick.log - This is the logfile which logs all activity of note
that happens inside Magick.  The verbosity of this log file can
vary depending on the --debug option, or the VERBOSE config option.
This file may be zero'd without any detremental effects, or if
it is removed, the OFF and ON online commands will re-establish
the filehandle. This filename is a setting in the magick.ini file,
and may be changed.  This file is created if it doesnt exist.

magick.pid - This file indicates the process ID of the currently
running Magick on UNIX-based systems.  This may be used to easily
determine if Magick is running, and to kill a running copy. This
filename is a setting in the magick.ini file, and may be changed.
This file is overwritten on Magick startup.

magick.motd - This contains the text of the server motd that will
be displayed to any user who types /MOTD services.server in their
IRC client. This filename is a setting in the magick.ini file, and
may be changed.

magick.key - This contains the key for your databases, encrypted.
This key file should be generated with magick_keygen.  This file
may not be used by more than one set of services (unless the binaries
are copied), as each compile requires regenerating this file.  This
filename is a setting in the magick.ini file, and may be changed.

lang/*.lng - These files contain the responses Magick will send back
to users for any command, or output from any procedure.  These files
are 'tokenized', and are substituted with actual values.  The default
language file to used is set by the DEF_LANGUAGE paramater in the
magick.ini file, however languages may be set per-user.

lang/*.lfo - These files contain the log file outputs Magick will
use for all messages going to the magick.log file.  These files are
'tokenized', and are substituted with actual values.  The file that
is used is set by the DEF_LANGUAGE paramater in the magick.ini file.

lang/*.hlp - These files contain the help text that Magick uses to
respond to all HELP commands.  The default help file used is set by
the DEF_LANGUAGE paramater in the magick.ini file, however languages
may be set per-user.

files/pic - This directory is where all user's pictures are stored.
The files themselves are stored as hexidecimal numbers, with no
extension -- the map to real filenames is stored in the database.
The path name actually used is a setting in the magick.ini file.

files/memo - This directory is where all attachments are stored.
The files themselves are stored as hexidecimal numbers, with no
extension -- the map to real filenames is stored in the database.
The path name actually used is a setting in the magick.ini file.

files/public - This directory is where all files in the public
filesystem (uploaded by SOPS only)are stored. The files themselves
are stored as hexidecimal numbers, with no extension -- the map to
real filenames is stored in the database. The path name actually
used is a setting in the magick.ini file.

files/temp - This directory is where all files involved in DCC
transfers (sending or receiving) are stored.  These files are
considered volatile, and if Magick is not running, can safely be
removed. The files themselves are stored as hexidecimal numbers,
with no extension. The path name actually used is a setting in the
magick.ini file.

4. OPERATION
============

Magick once started, becomes a background process.  It accepts
a number of command-line options that override the settings of
their equivilants on load.  NOTE: If the config file is loaded
again at runtime, the settings in the config file will be used.

--help (or -?)	Help output (summary of the below).
--dir X		Set the initial services directory.
--config X	Set the name (and/or path) of the config file.
--convert X	Convert another version of services databases
		to Magick II format, where X is the type of
		database to convert.  Currently recognized:
			magick
--trace X:Y	Set the trace level on startup, equivilant of
		using the OperServ TRACE SET command while
		running, where X is the trace type (or ALL), and
		Y is the trace level in hex.

All other command line options just override the configuration
file settings.  Below is a list of the overrides available, and
the settings they override in the configuration file.  Please see
the configuration file's comments for more information on each
option, and what it does.

PARAMATER	SHORT	GROUP		OPTION
---------	-----	-----		------
--name X	-n	STARTUP		SERVER_NAME
--desc X	-d	STARTUP		SERVER_DESC
--user X	-u	STARTUP		SERVICES_USER
--host X	-h	STARTUP		SERVICES_HOST
--ownuser	-o	STARTUP		OWNUSER=true
--protocol X	-P	STARTUP		PROTOCOL
--level X	-l	STARTUP		LEVEL
--lagtime X	-g	STARTUP		LAGTIME
--verbose	-v	FILES		VERBOSE=true
--log X		-L	FILES		LOGFILE
--dbase X	-D	FILES		DATABASE
--langdir X	-S	FILES		LANGDIR
--encrypt	-E	FILES		ENCRYPTION=true
--decrypt	-e	FILES		ENCRYPTION=false
--keyfile X	-K	FILES		KEYFILE
--compress X	-c	FILES		COMPRESSION
--relink X	-r	CONFIG		SERVER_RELINK
--save X	-w	CONFIG		SAVETIME
--cycle X	-t	CONFIG		CYCLETIME
--check X	-T 	CONFIG		CHECKTIME
--ping X	-p	CONFIG		PING_FREQUENCY
--threads X	-X	CONFIG		MIN_THREADS
--lwm X		-m	CONFIG		LOW_WATER_MARK
--hwm X		-M	CONFIG		HIGH_WATER_MARK
--append	-a	NICKSERV	APPEND_RENAME=true
--rename	-A	NICKSERV	APPEND_RENAME=false
--ident X	-R	NICKSERV	IDENT
--language X	-s	NICKSERV	DEF_LANGUAGE
--nodcc		-x	NICKSERV	PICEXT=  (nothing)
			MEMOSERV	FILES=0
--inflight X	-f	MEMOSERV	INFLIGHT
--logignore	-i	OPERSERV	LOG_IGNORE=true
--ignore X      -I	OPERSERV	IGNORE_METHOD

Example:

./magick --config /etc/magick.ini

5. FUNCTIONALITY
================

Magick has 6 main services, and offers the ability to script either
added functionality to these existing services, or create totally
new services through its scripting language.  This section gives an
overview of the main functionality and purpose of the hard-coded
services.  Please note, the actual nicknames of each of the below
services may be different on each network.

NickServ is a services that allows users to register their IRC
nicknames so that noone else may take them.  Users may then set
various options on their nickname record, such as privacy mode,
kill protection, etc that affect the way their nickname is
treated, and how services respond to them.  They may also set
purely informational fields in their nickname record thay is
displayed on an INFO request.  NickName registration is required
to execute many other commands in services, be added to a channel
access list, or receive memos from other users.

ChanServ is a service that allows users to register a channel on
the IRC network, so that they may specify who has access to them,
and who shall be automatically kicked from them.  This not only
prevents such things as channel takeovers, but establishes a
definate 'seniority' system in the channel.  ChanServ also allows
users to set various options on their channel records, from the
purely informational that is displayed in an INFO request, to
options that change the behavior of services, and how users are
treated in a channel.  This service also offers such features as
on-join greetings, user-based greetings, etc.

MemoServ is a service that allows users to send memos to other
users, or post news articles to channels.  This service also
allows such features as forwarding, or replying to memos, and
even attaching files via. DCC to memos (to other users only).
This service also intergrates with NickServ's ignore list, and
ChanServ's access list to vary the ability to send, or read
memos or news articles.

CommServ is a service that maintains 'committees' or groups of
users.  These groups can be simply a list of users who have a
common interest, or can alter a user's access to certain features
of services.  You may also send memos to all members of a committee
or set logon messages for committees that all members will see
on signon.  Services has 6 'default' committees:
	SADMIN	- Services Adminstrators - Members of this
		  committee are hard-coded into the Magick
		  configuration file.
	SOP	- Services Operators - Members of this committee
		  are added by members of the SADMIN committee.
	ADMIN	- Server Administrators - Members of this committee
		  are added by members of the SADMIN committee.
	OPER	- IRC Operators - Members of this committee are
		  added by members of the ADMIN committee.
	REGD	- All Registered Users - This committee may not be
		  modified, and its members are dynamic.
	ALL	- All Users - This committee may not be modified,
		  and its members are dynamic.

OperServ is a services that allows IRC Operators to keep control
on the network.  This service offers functions like an Automatic
Kill list, Clone Protection (and overriding), Services Ignore,
IRC Operator Denying, aswell as the ability to JUPE (fake-link)
a server, change a user or channels modes, and many more funcitons.

ServMsg is mainly an informational service, users may get help,
statistics and information about services, and the network they
are connected to from this service.  This service also offers the
ability for Server Administrators to send a global message that
will be sent to all users on the network, and services operators
to offer files to users throuh the public file system.
